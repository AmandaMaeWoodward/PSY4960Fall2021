---
title: "PRESS v2 data analysis"
author: "Amanda Mae Woodward"
date: "7/26/2021"
output: html_document
---
```{r openLibraries}
library(tidyverse)

```

```{r loadData}
dat<- read.csv("~/Desktop/PRESSAnalyses/PRESS2Clean.csv", row.names=1)
```

## Do children respond differently when undeserved blame is directed at a social or nonsocial target? 

Do children protest blame  of a social target or nonsocial target more? 									
Analysis:	Linear Regression								
Outcome: 	the number of times children protest during the blame phase								
Predictor:	Condition (social or nonsocial)								
Preliminary Analysis Predictors: 	Child's Sex 								

```{r}
colnames(dat)
lm1<- lm(protest ~condition +ageYear+sex, data=dat)
summary(lm1)
```
no factors predicted children's protests

```{r}
t.test(protest~condition, data=dat)
```
**Interpretation:** there is no significant difference between social and nonsocial conditions. 

Does the strength of children's protest differ when a social or nonsocial target is blamed? 
Analysis:	Linear Regression					
Outcome:	strength of children's strongest protest					
Predictor:	Condition (social or nonsocial)					
Preliminary Analysis Predictors:	Child's Sex 					
```{r}
dat$blameProtestClarificationp1<- as.numeric(dat$blameProtestClarificationp1)
dat$blameProtestClarificationp2<- as.numeric(dat$blameProtestClarificationp2)
dat$blameProtestClarificationp3<- as.numeric(dat$blameProtestClarificationp3)
dat$blameProtestClarificationp4<- as.numeric(dat$blameProtestClarificationp4)
dat$blameProtestClarificationp5<- as.numeric(dat$blameProtestClarificationp5)

dat$strongestProtestBlame<-rep(NA, nrow(dat))
for (i in 1:nrow(dat)){
dat$strongestProtestBlame[i]<-(max(c(dat$blameProtestClarificationp1[i],dat$blameProtestClarificationp2[i], dat$blameProtestClarificationp3[i], dat$blameProtestClarificationp4[i], dat$blameProtestClarificationp5[i]), na.rm=TRUE))
}
dat$strongestProtestBlame<-ifelse(dat$strongestProtestBlame==-Inf, NA, dat$strongestProtestBlame)
```

```{r}
lm2<- lm(strongestProtestBlame~condition +ageYear, data=dat)
summary(lm2)
```
**Interpretation:** There is no significant predictor of children's strongest protest score

```{r}
t.test(strongestProtestBlame~condition, data=dat, var.equal = TRUE)
```
**Interpretation:** There is no difference in the strength of protests across conditions. 

Do children protest earlier when a social or nonsocial target is blamed?						
Analysis:	Linear Regression					
Outcome:	phase in which children first protest 					
Predictor:	Condition (social or nonsocial)					
Preliminary Analysis Predictors:	Child's Sex 					
```{r}
dat$firstProtestBlame<- rep(NA, nrow(dat))
for (i in 1:nrow(dat)){
  if(dat$p1[i] == "p"){
    dat$firstProtestBlame[i]<- "p1"
  } else if(dat$p2[i]== "p"){
    dat$firstProtestBlame[i]<- "p2"
  }  else if(dat$p3[i]== "p"){
    dat$firstProtestBlame[i]<- "p3"
  }  else if(dat$p4[i]== "p"){
    dat$firstProtestBlame[i]<- "p4"
  }  else if(dat$p5[i]== "p"){
    dat$firstProtestBlame[i]<- "p5"
  }else {dat$firstProtestBlame[i]<-NA}
}
```
```{r}
dat$firstProtestBlame<- as.factor(dat$firstProtestBlame)
levels(dat$firstProtestBlame)<- c(1,2,3,5)
dat$firstProtestBlame<-as.numeric(levels(dat$firstProtestBlame))[dat$firstProtestBlame]
lm3<- glm(firstProtestBlame~condition+ sex+ageYear, data=dat, family="poisson")
summary(lm3)
```
**Interpretation:** There are no significant predictors of children's first protest
```{r}
t.test(firstProtestBlame~condition, data=dat, var.equal=TRUE)
```
Do children protest blame  of a social target or nonsocial target more? 									
Analysis:	Linear Regression								
Outcome: 	the number of times children protest during the blame phase								
Predictor:	Condition (social or nonsocial)	

Preliminary Analysis Predictors: 	Child's Sex 						

```{r}
lm4<- lm(affirmation ~condition +ageYear+sex, data=dat)
summary(lm4)
```
no factors predicted children's protests

```{r}
t.test(affirmation~condition, data=dat)
```
**Interpretation:** there is no significant difference between social and nonsocial conditions. 

Does the strength of children's protest differ when a social or nonsocial target is blamed? 
Analysis:	Linear Regression					
Outcome:	strength of children's strongest protest					
Predictor:	Condition (social or nonsocial)					
Preliminary Analysis Predictors:	Child's Sex 					
```{r}
dat$blameAffirmClarificationp2<- as.numeric(dat$blameAffirmClarificationp2)
dat$blameAffirmClarificationp3<- as.numeric(dat$blameAffirmClarificationp3)
dat$blameAffirmClarificationp4<- as.numeric(dat$blameAffirmClarificationp4)

dat$strongestAffirmBlame<-rep(NA, nrow(dat))
for (i in 1:nrow(dat)){
dat$strongestAffirmBlame[i]<-(max(c(dat$blameAffirmClarificationp2[i], dat$blameAffirmClarificationp3[i], dat$blameAffirmClarificationp4[i]), na.rm=TRUE))
}
dat$strongestAffirmBlame<-ifelse(dat$strongestAffirmBlame==-Inf, NA, dat$strongestAffirmBlame)
```

```{r}
lm5<- lm(strongestAffirmBlame~condition +ageYear, data=dat)
summary(lm5)
```
**Interpretation:** There is no significant predictor of children's strongest protest score

```{r}
t.test(strongestAffirmBlame~condition, data=dat, var.equal = TRUE)
```
**Interpretation:** There is no difference in the strength of protests across conditions. 

Do children protest earlier when a social or nonsocial target is blamed?						
Analysis:	Linear Regression					
Outcome:	phase in which children first protest 					
Predictor:	Condition (social or nonsocial)					
Preliminary Analysis Predictors:	Child's Sex 					
```{r}
dat$firstAffirmBlame<- rep(NA, nrow(dat))
for (i in 1:nrow(dat)){
   if(dat$p2[i]== "a"){
    dat$firstAffirmBlame[i]<- "p2"
  }  else if(dat$p3[i]== "a"){
    dat$firstAffirmBlame[i]<- "p3"
  }  else if(dat$p4[i]== "a"){
    dat$firstAffirmBlame[i]<- "p4"
  }  else {dat$firstAffirmBlame[i]<-NA}
}
```
```{r}
dat$firstAffirmBlame<- as.factor(dat$firstAffirmBlame)
levels(dat$firstAffirmBlame)<- c(2,3,4)
dat$firstAffirmBlame<-as.numeric(levels(dat$firstAffirmBlame))[dat$firstAffirmBlame]
lm6<- glm(firstAffirmBlame~condition+ sex+ageYear, data=dat, family="poisson")
summary(lm6)
```
**Interpretation:** There are no significant predictors of children's first protest
```{r}
t.test(firstAffirmBlame~condition, data=dat, var.equal=TRUE)
```

Do children think it is worse to call a social target, rather than a nonsocial target, awful? 						
Analysis: 	t-test					
Outcome:	Scale response to question					
Groups:	Social vs Nonsocial condition					
```{r}
t.test(thinkBabaScale~condition, data=dat, var.equal=TRUE)
```
There is no difference in chidlren's ratings

Do children think that it's worse to tell everyone that a social target is awful, rather than a nonsocial target? 						
Analysis: 	t-test					
Outcome:	Scale response to question					
Groups:	Social vs Nonsocial condition					
```{r}
t.test(tellEvScale~condition, data=dat, var.equal=TRUE)
```
There is no difference in chidlren's ratings


